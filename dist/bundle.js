(()=>{"use strict";var t=function(){function t(t,e,n,r){this.providedAnswer="",this.id=t,this.text=e,this.options=n,this.correctAnswer=r}return t.prototype.answer=function(t){if(this.isAnswered())throw new Error("Can not answer twice on the same question");return this.providedAnswer=t,t===this.correctAnswer},t.prototype.recallAnswer=function(){this.providedAnswer=""},t.prototype.isAnswered=function(){return""!==this.providedAnswer},t.prototype.render=function(t){if(this.isAnswered())return this.renderSummary();var e=document.createElement("div"),n="";n+='<p class="test-question">'+this.id+". "+this.text+"</p>";for(var r=0,i=this.options;r<i.length;r++){var o=i[r];n+='<div class="answer-option" data-option="'+o+'">'+o+"</div>"}return e.innerHTML=n,e.querySelectorAll('div[class="answer-option"]').forEach((function(e){var n=e;n.addEventListener("click",(function(){return t(n.dataset.option)}))})),e},t.prototype.renderSummary=function(){var t=document.createElement("div"),e="";return e+="<p>"+this.id+". "+this.text+"</p>",this.providedAnswer===this.correctAnswer?e+="<p>✅ "+this.providedAnswer+"</p>":e+="<p>⚠️ "+this.providedAnswer+" (правильно: "+this.correctAnswer+")</p>",t.innerHTML=e,t},t}();const e=t;const n=function(){function t(t){this.questions=t,this.currentQuestionNumber=0,this.result=[]}return t.prototype.getCurrentQuestion=function(){var t;return null!==(t=this.questions[this.currentQuestionNumber])&&void 0!==t?t:null},t.prototype.answer=function(t){var e=this.getCurrentQuestion();null!==e?(e.answer(t),e.isAnswered()&&(this.result[this.currentQuestionNumber]=e,this.currentQuestionNumber+=1)):console.error("Runtime error: there are no questions left")},t.prototype.getResult=function(){return this.result},t.prototype.reset=function(){this.result=[],this.currentQuestionNumber=0;for(var t=0,e=this.questions;t<e.length;t++){e[t].recallAnswer()}},t}();var r=function(){function t(t){this.testUI=document.getElementById("test"),this.test=t,document.getElementById("content").style.display="none"}return t.prototype.render=function(){var t=this;this.testUI.style.display="block";var e,n=this.test.getCurrentQuestion();e=null!==n?n.render((function(e){t.test.answer(e),t.render()})):this.renderResult(),this.testUI.replaceChildren(e)},t.prototype.renderResult=function(){for(var t=this,e=document.createElement("div"),n=0,r=this.test.getResult();n<r.length;n++){var i=r[n];e.appendChild(i.render((function(){})))}var o=document.createElement("button");return o.innerText="Начать тест заново",o.addEventListener("click",(function(){t.test.reset(),t.render()})),e.appendChild(o),e},t}();const i=r;const o=function(){function t(){var t=document.getElementById("tooltip");null==t&&((t=document.createElement("span")).className="tooltip",t.id="tooltip",t.style.visibility="hidden",document.body.appendChild(t)),this.element=t}return t.prototype.show=function(t,e){if("visible"!==this.element.style.visibility){var n=this.getElementOffset(e);this.element.style.visibility="visible",this.element.innerText=t,this.element.style.left=n.left+"px",this.element.style.top=n.top-20+"px"}},t.prototype.hide=function(){this.element.style.visibility="hidden",this.element.innerText=""},t.prototype.getElementOffset=function(t){var e=t.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY}},t}();const s=function(){function t(t,e,n){this.id=t,this.text=e,this.answers=n,this.providedAnswers=[]}return t.prototype.answer=function(t){this.providedAnswers[t.part]=t.text},t.prototype.recallAnswer=function(){this.providedAnswers=[]},t.prototype.render=function(t){var e=this;if(this.isAnswered())return this.renderSummary();var n=document.createElement("div");return n.appendChild(document.createTextNode(this.id+". ")),this.text.split(/({\d})/).forEach((function(r){if(/^{\d}$/.test(r)){var i=r.match(/\d/).shift(),o="______";e.providedAnswers.hasOwnProperty(i)&&(o=e.providedAnswers[i]);var s=document.createElement("span");s.id=e.getOptionId(i),s.innerHTML='<span style="color:gray;">'+o+"</span>",s.addEventListener("click",(function(){if(!e.isAnswered()){var r=document.createElement("div");r.className="options show",Object.values(e.answers).forEach((function(e){var o=document.createElement("div");o.className="option",o.textContent=e,o.addEventListener("click",(function(){n.removeChild(r),t({part:i,text:e})})),r.appendChild(o)})),n.appendChild(r)}})),n.appendChild(s)}else n.appendChild(document.createTextNode(r))})),n},t.prototype.isAnswered=function(){return Object.keys(this.providedAnswers).length===Object.keys(this.answers).length},t.prototype.getOptionId=function(t){return"answer-"+t},t.prototype.renderSummary=function(){var t=this;if(!this.isAnswered())throw new Error("Can not show summary for unanswered question");var e=new o,n=document.createElement("div");return n.appendChild(document.createTextNode(this.id+". ")),this.text.split(/({\d})/).forEach((function(r){if(/^{\d}$/.test(r)){var i=r.match(/\d/).shift(),o=t.providedAnswers[i],s=t.answers[i],c=document.createElement("span");c.innerText=o,c.style.color="green",o!==s&&(c.style.color="yellow",c.addEventListener("mouseover",(function(t){var n=t.target;e.show("Правильно: "+s,n)})),c.addEventListener("mouseout",(function(){return e.hide()}))),n.appendChild(c)}else n.appendChild(document.createTextNode(r))})),n},t}();const c=function(){function t(){}return t.createTranslationTest=function(t){var r=function(){return.5-Math.random()},o=function(e,n){var i=Object.values(t).sort(r);if(i.length-1<n)throw new Error("Requested more translations than we can provide");for(var o=[e];o.length<n+1;){var s=i.shift();s!==e&&o.push(s)}return o.sort(r)},s=[],c=1;for(var d in t)s.push(new e((c++).toString(),'Как сказать "'+d+'"?',o(t[d],3),t[d]));return new i(new n(s))},t.createChoiceTest=function(t){for(var r=[],o=1,s=0,c=t;s<c.length;s++){var d=c[s];r.push(new e((o++).toString(),d.text,d.choices,d.answer))}return new i(new n(r))},t.createMultiChoiceTest=function(t){for(var e=[],r=1,o=0,c=t;o<c.length;o++){var d=c[o];e.push(new s((r++).toString(),d.text,d.choices))}return new i(new n(e))},t}();var d,a={family:"семья"},u={family:[{origin:"Ила",translation:"Мама",picture:"https://cdn-icons-png.freepik.com/256/4478/4478085.png"},{origin:"Илабаба",translation:"Бабушка",picture:"https://cdn-icons-png.freepik.com/256/1155/1155223.png"},{origin:"Дада",translation:"Папа",picture:"https://cdn-icons-png.freepik.com/256/2202/2202112.png"},{origin:"Имадада",translation:"Дедушка",picture:"https://cdn-icons-png.freepik.com/256/5596/5596914.png"},{origin:"Кунтlа",translation:"Муж",picture:"https://cdn-icons-png.freepik.com/256/2202/2202112.png"},{origin:"Гьарукlкlа",translation:"Жена",picture:"https://cdn-icons-png.freepik.com/256/4478/4478085.png"},{origin:"Яци",translation:"Сестра",picture:"https://cdn-icons-png.freepik.com/256/8348/8348186.png"},{origin:"Ваци",translation:"Брат",picture:"https://cdn-icons-png.freepik.com/256/4333/4333609.png"},{origin:"Вохья",translation:"Сын",picture:"https://cdn-icons-png.freepik.com/256/7088/7088431.png"},{origin:"Йехьи",translation:"Дочь",picture:"https://cdn-icons-png.freepik.com/256/2465/2465392.png"},{origin:"Илеци",translation:"Тётя(мамина сестра)",picture:"https://cdn-icons-png.freepik.com/256/4244/4244102.png"},{origin:"Имеци",translation:"Тётя(папина сестра)",picture:"https://cdn-icons-png.freepik.com/256/9119/9119027.png"},{origin:"Илоци",translation:"Дядя(мамин брат)",picture:"https://cdn-icons-png.freepik.com/256/2599/2599265.png"},{origin:"Имоци",translation:"Дядя(папин брат)",picture:"https://cdn-icons-png.freepik.com/256/3428/3428474.png"},{origin:"Хъизан",translation:"Семья",picture:"https://cdn-icons-png.freepik.com/256/15371/15371705.png"}]};!function(t){t.FAMILY="family"}(d||(d={}));const p=function(){function t(t){this.tooltip=new o,this.UI=document.createElement("div"),this.UI.className="wordbook",t.appendChild(this.UI)}return t.prototype.render=function(t){for(var e,n=[],r={},i=0,o=u[t];i<o.length;i++){var s=o[i];n.push(this.renderEntry(s)),r[s.translation]=s.origin}n.push(this.renderStartTestButton(r)),(e=this.UI).replaceChildren.apply(e,n),document.getElementsByTagName("h1").item(0).innerText=a[t]},t.prototype.renderEntry=function(t){var e=this,n=document.createElement("div"),r=document.createElement("img"),i=document.createElement("p");return r.src=t.picture,r.title=t.translation,i.innerText=t.origin,n.append(r,i),n.addEventListener("mouseover",(function(){e.tooltip.show(t.translation,r)})),n.addEventListener("mouseout",(function(){return e.tooltip.hide()})),n},t.prototype.renderStartTestButton=function(t){var e=document.createElement("button");return e.id="start-test",e.innerText="Быстрый тест",e.addEventListener("click",(function(){c.createTranslationTest(t).render()})),e},t}();var l=!0;document.addEventListener("DOMContentLoaded",(function(){l=!1;for(var t=document.querySelectorAll("[data-description]"),e=new o,n=0;n<t.length;n++)t[n].addEventListener("mouseover",(function(t){var n=t.target;e.show(n.dataset.description,n)})),t[n].addEventListener("mouseout",(function(){return e.hide()}))}));var h=window;h.registerTranslationTest=function(t){document.addEventListener("DOMContentLoaded",(function(){document.getElementById("start-test").addEventListener("click",(function(){c.createTranslationTest(t).render()}))}))},h.registerChoiceTest=function(t){document.addEventListener("DOMContentLoaded",(function(){document.getElementById("start-test").addEventListener("click",(function(){c.createChoiceTest(t).render()}))}))},h.registerMultiChoiceTest=function(t){document.addEventListener("DOMContentLoaded",(function(){document.getElementById("start-test").addEventListener("click",(function(){c.createMultiChoiceTest(t).render()}))}))},h.showWordbookChapter=function(t){if(l)setTimeout((function(){h.showWordbookChapter(t)}),100);else{var e=document.getElementById("content");e.innerHTML="",new p(e).render(t)}}})();