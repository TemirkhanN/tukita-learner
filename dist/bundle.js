(()=>{"use strict";var e=function(){function e(e,t,n,r){this.providedAnswer="",this.id=e,this.text=t,this.options=n,this.correctAnswer=r}return e.prototype.answer=function(e){if(this.isAnswered())throw new Error("Can not answer twice on the same question");return this.providedAnswer=e,e===this.correctAnswer},e.prototype.recallAnswer=function(){this.providedAnswer=""},e.prototype.isAnswered=function(){return""!==this.providedAnswer},e.prototype.render=function(e){if(this.isAnswered())return this.renderSummary();var t=document.createElement("div"),n="";n+='<p class="test-question">'+this.id+". "+this.text+"</p>";for(var r=0,i=this.options;r<i.length;r++){var o=i[r];n+='<div class="answer-option">   <input type="radio" name="answer" value="'+o+'"/>   <label for="answer">'+o+"</label></div>"}return t.innerHTML=n,t.querySelectorAll('input[type="radio"]').forEach((function(t){var n=t;n.addEventListener("click",(function(){return e(n.value)}))})),t},e.prototype.renderSummary=function(){var e=document.createElement("div"),t="";return t+="<p>"+this.id+". "+this.text+"</p>",this.providedAnswer===this.correctAnswer?t+="<p>✅ "+this.providedAnswer+"</p>":t+="<p>⚠️ "+this.providedAnswer+" (правильно: "+this.correctAnswer+")</p>",e.innerHTML=t,e},e}();const t=e;const n=function(){function e(e){this.questions=e,this.currentQuestionNumber=0,this.result=[]}return e.prototype.getCurrentQuestion=function(){var e;return null!==(e=this.questions[this.currentQuestionNumber])&&void 0!==e?e:null},e.prototype.answer=function(e){var t=this.getCurrentQuestion();null!==t?(t.answer(e),t.isAnswered()&&(this.result[this.currentQuestionNumber]=t,this.currentQuestionNumber+=1)):console.error("Runtime error: there are no questions left")},e.prototype.getResult=function(){return this.result},e.prototype.reset=function(){this.result=[],this.currentQuestionNumber=0;for(var e=0,t=this.questions;e<t.length;e++){t[e].recallAnswer()}},e}();var r=function(){function e(e){this.testUI=document.getElementById("test"),this.test=e,document.getElementById("content").style.display="none"}return e.prototype.render=function(){var e=this;this.testUI.style.display="block";var t,n=this.test.getCurrentQuestion();t=null!==n?n.render((function(t){e.test.answer(t),e.render()})):this.renderResult(),this.testUI.replaceChildren(t)},e.prototype.renderResult=function(){for(var e=this,t=document.createElement("div"),n=0,r=this.test.getResult();n<r.length;n++){var i=r[n];t.appendChild(i.render((function(){})))}var o=document.createElement("button");return o.innerText="Начать тест заново",o.addEventListener("click",(function(){e.test.reset(),e.render()})),t.appendChild(o),t},e}();const i=r;const o=function(){function e(){var e=document.getElementById("tooltip");null===e&&(console.log("it's null. chill"),(e=document.createElement("span")).className="tooltip",e.id="tooltip",e.style.visibility="hidden",document.body.appendChild(e)),this.element=e}return e.prototype.show=function(e,t){if("visible"!==this.element.style.visibility){var n=this.getElementOffset(t);this.element.style.visibility="visible",this.element.innerText=e,this.element.style.left=n.left+"px",this.element.style.top=n.top-20+"px"}},e.prototype.hide=function(){this.element.style.visibility="hidden",this.element.innerText=""},e.prototype.getElementOffset=function(e){var t=e.getBoundingClientRect();return{left:t.left+window.scrollX,top:t.top+window.scrollY}},e}();const s=function(){function e(e,t,n){this.id=e,this.text=t,this.answers=n,this.providedAnswers=[]}return e.prototype.answer=function(e){this.providedAnswers[e.part]=e.text},e.prototype.recallAnswer=function(){this.providedAnswers=[]},e.prototype.render=function(e){var t=this;if(this.isAnswered())return this.renderSummary();var n=document.createElement("div");return n.appendChild(document.createTextNode(this.id+". ")),this.text.split(/({\d})/).forEach((function(r){if(/^{\d}$/.test(r)){var i=r.match(/\d/).shift(),o="______";t.providedAnswers.hasOwnProperty(i)&&(o=t.providedAnswers[i]);var s=document.createElement("span");s.id=t.getOptionId(i),s.innerHTML='<span style="color:gray;">'+o+"</span>",s.addEventListener("click",(function(){if(!t.isAnswered()){var r=document.createElement("div");r.className="options show",Object.values(t.answers).forEach((function(t){var o=document.createElement("div");o.className="option",o.textContent=t,o.addEventListener("click",(function(){n.removeChild(r),e({part:i,text:t})})),r.appendChild(o)})),n.appendChild(r)}})),n.appendChild(s)}else n.appendChild(document.createTextNode(r))})),n},e.prototype.isAnswered=function(){return Object.keys(this.providedAnswers).length===Object.keys(this.answers).length},e.prototype.getOptionId=function(e){return"answer-"+e},e.prototype.renderSummary=function(){var e=this;if(!this.isAnswered())throw new Error("Can not show summary for unanswered question");var t=new o,n=document.createElement("div");return n.appendChild(document.createTextNode(this.id+". ")),this.text.split(/({\d})/).forEach((function(r){if(/^{\d}$/.test(r)){var i=r.match(/\d/).shift(),o=e.providedAnswers[i],s=e.answers[i],c=document.createElement("span");c.innerText=o,c.style.color="green",o!==s&&(c.style.color="yellow",c.addEventListener("mouseover",(function(e){var n=e.target;t.show("Правильно: "+s,n)})),c.addEventListener("mouseout",(function(){return t.hide()}))),n.appendChild(c)}else n.appendChild(document.createTextNode(r))})),n},e}();const c=function(){function e(){}return e.createTranslationTest=function(e){var r=function(){return.5-Math.random()},o=function(t,n){var i=Object.values(e).sort(r);if(i.length-1<n)throw new Error("Requested more translations than we can provide");for(var o=[t];o.length<n+1;){var s=i.shift();s!==t&&o.push(s)}return o.sort(r)},s=[],c=1;for(var d in e)s.push(new t((c++).toString(),'Как сказать "'+d+'"?',o(e[d],3),e[d]));return new i(new n(s))},e.createChoiceTest=function(e){for(var r=[],o=1,s=0,c=e;s<c.length;s++){var d=c[s];r.push(new t((o++).toString(),d.text,d.choices,d.answer))}return new i(new n(r))},e.createMultiChoiceTest=function(e){for(var t=[],r=1,o=0,c=e;o<c.length;o++){var d=c[o];t.push(new s((r++).toString(),d.text,d.choices))}return new i(new n(t))},e}();var d,u={family:"семья"},a={family:[{origin:"Ила",translation:"Мама",picture:"https://cdn-icons-png.freepik.com/256/4478/4478085.png"},{origin:"Илабаба",translation:"Бабушка",picture:"https://cdn-icons-png.freepik.com/256/1155/1155223.png"},{origin:"Имадада",translation:"Дедушка",picture:"https://cdn-icons-png.freepik.com/256/5596/5596914.png"},{origin:"Дада",translation:"Папа",picture:"https://cdn-icons-png.freepik.com/256/2202/2202112.png"},{origin:"Яци",translation:"Сестра",picture:"https://cdn-icons-png.freepik.com/256/8348/8348186.png"},{origin:"Йехьи",translation:"Дочь",picture:"https://cdn-icons-png.freepik.com/256/2465/2465392.png"},{origin:"Вохьа",translation:"Сын",picture:"https://cdn-icons-png.freepik.com/256/7088/7088431.png"},{origin:"Ваци",translation:"Брат",picture:"https://cdn-icons-png.freepik.com/256/4333/4333609.png"},{origin:"Хъизан",translation:"Семья",picture:"https://cdn-icons-png.freepik.com/256/15371/15371705.png"}]};!function(e){e.FAMILY="family"}(d||(d={}));const l=function(){function e(e){this.tooltip=new o,this.UI=document.createElement("div"),this.UI.className="wordbook",e.appendChild(this.UI)}return e.prototype.render=function(e){for(var t,n=[],r=0,i=a[e];r<i.length;r++){var o=i[r];n.push(this.renderEntry(o))}(t=this.UI).replaceChildren.apply(t,n),document.getElementsByTagName("h1").item(0).innerText=u[e]},e.prototype.renderEntry=function(e){var t=this,n=document.createElement("div"),r=document.createElement("img"),i=document.createElement("p");return r.src=e.picture,r.title=e.translation,i.innerText=e.origin,n.append(r,i),n.addEventListener("mouseover",(function(){t.tooltip.show(e.translation,r)})),n.addEventListener("mouseout",(function(){return t.tooltip.hide()})),n},e}();var p=!0;document.addEventListener("DOMContentLoaded",(function(){p=!1;for(var e=document.querySelectorAll("[data-description]"),t=new o,n=0;n<e.length;n++)e[n].addEventListener("mouseover",(function(e){var n=e.target;t.show(n.dataset.description,n)})),e[n].addEventListener("mouseout",(function(){return t.hide()}))}));var h=window;h.registerTranslationTest=function(e){document.addEventListener("DOMContentLoaded",(function(){document.getElementById("start-test").addEventListener("click",(function(){c.createTranslationTest(e).render()}))}))},h.registerChoiceTest=function(e){document.addEventListener("DOMContentLoaded",(function(){document.getElementById("start-test").addEventListener("click",(function(){c.createChoiceTest(e).render()}))}))},h.registerMultiChoiceTest=function(e){document.addEventListener("DOMContentLoaded",(function(){document.getElementById("start-test").addEventListener("click",(function(){c.createMultiChoiceTest(e).render()}))}))},h.showWordbookChapter=function(e){if(p)setTimeout((function(){h.showWordbookChapter(e)}),100);else{var t=document.getElementById("content");t.innerHTML="",new l(t).render(e)}}})();